[gd_scene load_steps=10 format=3 uid="uid://b3n15fxxdcxq7"]

[ext_resource type="Script" uid="uid://clrhkvevap20h" path="res://scripts/enemy/enemy_controller.gd" id="1_7dwqs"]
[ext_resource type="Material" uid="uid://bw7qseeojktwo" path="res://assets/materials/player.tres" id="2_jfc8i"]
[ext_resource type="Script" uid="uid://fk0ptlx51pae" path="res://scripts/state_machine/state_machine.gd" id="2_taltf"]
[ext_resource type="Script" uid="uid://bpx1qyv8ow44p" path="res://scripts/enemy/enemy_idle_state.gd" id="3_4pfs4"]
[ext_resource type="Script" uid="uid://j2sybe2jtcf6" path="res://scripts/enemy/enemy_wandering_state.gd" id="4_qbybw"]
[ext_resource type="Script" uid="uid://drgt05kekpa0c" path="res://scripts/enemy/enemy_chase_state.gd" id="6_r2ggu"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_7xaro"]

[sub_resource type="CapsuleMesh" id="CapsuleMesh_7xaro"]

[sub_resource type="CylinderShape3D" id="CylinderShape3D_r2ggu"]
height = 1.0
radius = 5.0

[node name="CharacterBody3D" type="CharacterBody3D"]
script = ExtResource("1_7dwqs")

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("CapsuleShape3D_7xaro")

[node name="MeshInstance3D" type="MeshInstance3D" parent="CollisionShape3D"]
material_override = ExtResource("2_jfc8i")
mesh = SubResource("CapsuleMesh_7xaro")

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="."]
debug_enabled = true

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]

[node name="VisionArea" type="Area3D" parent="."]

[node name="VisionShape" type="CollisionShape3D" parent="VisionArea"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 5, 2, 0)
shape = SubResource("CylinderShape3D_r2ggu")

[node name="EnemyStateMachine" type="Node3D" parent="." node_paths=PackedStringArray("CURRENT_STATE")]
script = ExtResource("2_taltf")
CURRENT_STATE = NodePath("EnemyWanderingState")

[node name="EnemyIdleState" type="Node" parent="EnemyStateMachine"]
script = ExtResource("3_4pfs4")

[node name="EnemyWanderingState" type="Node" parent="EnemyStateMachine"]
script = ExtResource("4_qbybw")

[node name="EnemyChaseState" type="Node" parent="EnemyStateMachine" node_paths=PackedStringArray("NAVIGATION_AGENT_3D")]
script = ExtResource("6_r2ggu")
NAVIGATION_AGENT_3D = NodePath("../../NavigationAgent3D")

[connection signal="body_entered" from="VisionArea" to="EnemyStateMachine/EnemyWanderingState" method="_on_vision_area_body_entered"]
